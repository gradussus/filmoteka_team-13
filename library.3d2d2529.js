const e={modal:document.querySelector("[data-modal-footer]"),closeBtn:document.querySelector(".footer-modal__closeBtn"),openFooterModalBtn:document.querySelector(".js-team")};function t(i){"Escape"===i.code&&(e.modal.classList.add("is-hidden"),document.removeEventListener("keydown",t),document.removeEventListener("click",s))}function s(i){i.target===e.modal&&(e.modal.classList.add("is-hidden"),document.removeEventListener("click",s),document.removeEventListener("keydown",t))}e.openFooterModalBtn.addEventListener("click",(i=>{i.preventDefault(),e.modal.classList.remove("is-hidden"),document.addEventListener("keydown",t),document.addEventListener("click",s)})),e.closeBtn.addEventListener("click",(i=>{i.preventDefault(),e.modal.classList.add("is-hidden"),document.removeEventListener("keydown",t),document.removeEventListener("click",s)}));const i={backdrop:document.querySelector(".backdrop"),teamLink:document.querySelector(".js-team"),spinerBackdrop:document.querySelector(".spiner__backdrop"),filmsListRef:document.querySelector(".films"),gallery:document.querySelector(".gallery__set"),libGallery:document.querySelector(".lib-gallery__set"),container:document.getElementById("pagination"),galleryGenreItem:document.querySelector(".film__genres"),form:document.querySelector(".header-film__form"),closeModalBtnForOneMovie:document.querySelector(".modal__button"),modalForOneMovie:document.querySelector(".modal"),backdropOneMovie:document.querySelector(".backdrop"),btnAddToWatched:document.querySelector(".btn__modal-add"),btnRemoveFromWatched:document.querySelector(".btn__modal-r-watched"),btnAddToQuene:document.querySelector(".btn__modal-queue"),btnRemoveFromQuene:document.querySelector(".btn__modal-r-queue"),trailerBackdrop:document.querySelector(".js-backdrop-trailer")};function n(e,t){const s=JSON.parse(localStorage.getItem("genres")),i=[];for(let n=0;n<t&&n<e.length;n++)for(const t of s)e[n]===t.id&&i.push(t.name);return e.length>t&&i.splice(t-1,1,"Other"),i.join(", ")}function a(e){if(e)return e.length?void e.map((({poster_path:e,genre_ids:t,title:s,release_date:i,id:a})=>`<li class="films__item" id=${a||"No ID"}>\n                <div class="films__img">\n                    <img src=https://image.tmdb.org/t/p/original${e?`https://image.tmdb.org/t/p/w500${e}`:"https://image.tmdb.org/t/p/w500/yEvumAoCB9Z7o9dAzjxrjcwo2FQ.jpg"} alt="${s||"No title"}" loading="lazy" id=${a}>\n                </div>\n                <div class="films__description" id=${a}>\n                  <p class="films__title" id=${a}>${s||"No title"}</p>\n                  <div class="films__meta" id=${a}>\n                    <span class="films__genres" id=${a}>${n(t,3)||"No genres info"}</span>\n                    <span class="films__sep" id=${a}>|</span>\n                    <span class="films__data" id=${a}>${new Date(i).getFullYear()||"No info"}</span>\n                  </div>\n                </div>\n            </li>`)).forEach((e=>i.libGallery.insertAdjacentHTML("beforeend",e))):void o();o()}function o(){const e=document.createElement("IMG");e.src="https://pixabay.com/get/gefdffe0e3a111a2d5c539dc6a08c82b4b787e4962786126035071f95a2a5c46d2ebf8f194c8663dc4a63fb2935acb30d52287b634ea8567d22c059278eaa580d_1280.jpg",e.alt="plug",e.width="700",i.libGallery.append(e)}var l=document.createElement("script");l.src="https://www.youtube.com/iframe_api";var r=document.getElementsByTagName("script")[0];let d;async function c(){const e=document.querySelector(".play-trailer").id,t=await async function(e){try{const t=await fetch(`https://api.themoviedb.org/3/movie/${e}/videos?api_key=5d44c33850258a6ea050e461474b1468&language=en-US`);if(t.ok)return await t.json()}catch(e){console.log("error")}}(e);if(i.trailerBackdrop.classList.remove("is-hidden"),0===t.results.length)return void console.log("Нет в БД трейлера к этому фильму. Нам очень жаль.");let s=t.results.find((e=>"Trailer"===e.type&&"YouTube"===e.site));var n;n=s.key,d=new YT.Player("player",{height:"360",width:"640",videoId:n,playerVars:{autoplay:1,controls:1,rel:0},events:{onReady:u,onStateChange:m}})}function u(e){e.target.playVideo()}function m(e){}function h(){d.stopVideo()}r.parentNode.insertBefore(l,r),i.trailerBackdrop.addEventListener("click",(e=>{e.currentTarget.classList.toggle("is-hidden"),i.trailerBackdrop.innerHTML="",i.trailerBackdrop.innerHTML='<div class="modal__trailer" id="player"></div>',h()}));const g=new class{refreshData(){localStorage.getItem("watched-films")&&(this._watchedFilmsList=JSON.parse(localStorage.getItem("watched-films")))}refreshDataQueue(){localStorage.getItem("queue-films")&&(this._queueFilmsList=JSON.parse(localStorage.getItem("queue-films")))}addToWatchedFilms(e){localStorage.getItem("watched-films")&&(this._watchedFilmsList=JSON.parse(localStorage.getItem("watched-films"))),this._watchedFilmsList.push(e),this.saveWatchedFilms()}myAddToQueueFilms(e){localStorage.getItem("queue-films")&&(this._queueFilmsList=JSON.parse(localStorage.getItem("queue-films"))),this._queueFilmsList.push(e),localStorage.setItem("queue-films",JSON.stringify(this._queueFilmsList))}addToQueueFilms(e){localStorage.getItem("queue-films")&&(this._queueFilmsList=JSON.parse(localStorage.getItem("queue-films"))),this._queueFilmsList.push(e),this.saveQueueFilms()}saveWatchedFilms(){localStorage.setItem("watched-films",JSON.stringify(this._watchedFilmsList))}saveQueueFilms(){localStorage.setItem("queue-films",JSON.stringify(this._queueFilmsList))}getWathedFilmsList(){if(localStorage.getItem("watched-films"))return JSON.parse(localStorage.getItem("watched-films"))}getQueueFilmsList(){if(localStorage.getItem("queue-films"))return JSON.parse(localStorage.getItem("queue-films"))}removeFromWatched(e){if(!localStorage.getItem("watched-films"))return;this._watchedFilmsList=JSON.parse(localStorage.getItem("watched-films"));const t=this._watchedFilmsList.findIndex((t=>t.title===e.title));this._watchedFilmsList.splice(t,1),this.saveWatchedFilms()}removeFromQueue(e){if(!localStorage.getItem("queue-films"))return;this._queueFilmsList=JSON.parse(localStorage.getItem("queue-films"));const t=this._queueFilmsList.findIndex((t=>t.title===e.title));this._queueFilmsList.splice(t,1),this.saveQueueFilms()}checkFilmInWatchedLocStor(e){if(!localStorage.getItem("watched-films"))return;this._watchedFilmsList=JSON.parse(localStorage.getItem("watched-films"));return!!this._watchedFilmsList.find((t=>t.title===e.title))}checkFilmInQueueLocStor(e){if(!localStorage.getItem("queue-films"))return;this._queueFilmsList=JSON.parse(localStorage.getItem("queue-films"));return!!this._queueFilmsList.find((t=>t.title===e.title))}constructor(){this._watchedFilmsList=[],this._queueFilmsList=[],this.refreshData(),this.refreshDataQueue()}},p=document.querySelector(".modal__wrap");let _,f,b,v;i.closeModalBtnForOneMovie.addEventListener("click",(function(){i.backdropOneMovie.classList.add("is-hidden"),document.body.classList.remove("modal-open"),document.removeEventListener("keydown",q),document.removeEventListener("click",F)})),i.libGallery.addEventListener("click",(function(e){if(!function(e){const t=e.target.nodeName;return"plug"!==e.target.getAttribute("alt")&&("DIV"===t||"IMG"===t||"P"===t||"SPAN"===t)}(e))return;i.backdropOneMovie.classList.remove("is-hidden"),document.body.classList.add("modal-open");const t=function(e){let t=[];S.classList.contains("currentbtn")&&(t=JSON.parse(localStorage.getItem("watched-films")));y.classList.contains("currentbtn")&&(t=JSON.parse(localStorage.getItem("queue-films")));return L=t.find((t=>t.id===e)),L}(Number(e.target.id));(function({genre_ids:e,poster_path:t,original_title:s,overview:i,popularity:a,title:o,vote_average:l,vote_count:r,id:d}){p.innerHTML="";const c=t?`https://image.tmdb.org/t/p/w500${t}`:"https://image.tmdb.org/t/p/w500/yEvumAoCB9Z7o9dAzjxrjcwo2FQ.jpg";p.innerHTML=`\n  <div class="image__wrap">\n    <img class="image" src="https://image.tmdb.org/t/p/original${c}" alt="${o||"No title"}" />\n  </div>\n  <div class="description__wrap">\n    <h1 class="description__title">${o||"No title"}</h1>\n    <table>\n      <tr class="table__wrap">\n        <td class="description__table">Vote / Votes</td>\n        <td class="description__table-result">\n          <span class="votes">${l.toFixed(1)||"No data"}</span> /${r||"No data"}\n        </td>\n      </tr>\n      <tr class="table__wrap">\n        <td class="description__table">Popularity</td>\n        <td class="description__table-result">${a.toFixed(1)||"No data"}</td>\n      </tr>\n      <tr class="table__wrap">\n        <td class="description__table">Original Title</td>\n        <td class="description__table-result">${s||"No original title"}</td>\n      </tr>\n\n      <tr class="table__wrap">\n        <td class="description__table">Genre</td>\n        <td class="description__table-result">${n(e,100)||"No genres info"}</td>\n      </tr>\n    </table>\n    <p class="descrption__about">ABOUT</p>\n    <p class="description__text">\n     ${i||"There is no imformation about this movie"}\n    </p>\n    <ul class="btn__wrap">\n      <li>\n        <button class="btn btn__modal-add">add to Watched</button>\n        <button class="btn btn__modal-r-watched is-hidden">remove from Watched</button>\n      </li>\n      <li>\n        <button class="btn btn__modal-queue">add to queue</button>\n        <button class="btn btn__modal-r-queue is-hidden">remove from queue</button>\n      </li>\n    </ul>\n    <div class="btn__wrap">\n    <button class="btn play-trailer" id="${d}">Watch Trailer</button>\n    </div>\n  </div>\n`})(t),_=document.querySelector(".btn__modal-add"),f=document.querySelector(".btn__modal-queue"),v=document.querySelector(".btn__modal-r-queue"),b=document.querySelector(".btn__modal-r-watched"),_.addEventListener("click",w),b.addEventListener("click",k),f.addEventListener("click",I),v.addEventListener("click",E);document.querySelector(".play-trailer").addEventListener("click",c),document.addEventListener("keydown",q),document.addEventListener("click",F),g.checkFilmInWatchedLocStor(t)&&(_.classList.add("is-hidden"),b.classList.remove("is-hidden"));g.checkFilmInQueueLocStor(t)&&(f.classList.add("is-hidden"),v.classList.remove("is-hidden"))}));let L={};a(g.getWathedFilmsList());const y=document.querySelector(".queue-button"),S=document.querySelector(".watched-button");function q(e){"Escape"==e.code&&(i.backdropOneMovie.classList.add("is-hidden"),document.body.classList.remove("modal-open"))}function F(e){e.target==i.backdropOneMovie&&(i.backdropOneMovie.classList.add("is-hidden"),document.body.classList.remove("modal-open"))}function w(){g.refreshData(),g.addToWatchedFilms(L),g.saveWatchedFilms(),_.classList.add("is-hidden"),b.classList.remove("is-hidden"),S.classList.contains("currentbtn")&&(1===g.getWathedFilmsList().length&&(i.libGallery.innerHTML=""),O())}function k(){_.classList.remove("is-hidden"),b.classList.add("is-hidden"),g.removeFromWatched(L),S.classList.contains("currentbtn")&&N(),0===g.getWathedFilmsList().length&&o()}function I(){g.myAddToQueueFilms(L),f.classList.add("is-hidden"),v.classList.remove("is-hidden"),y.classList.contains("currentbtn")&&(1===g.getQueueFilmsList().length&&(i.libGallery.innerHTML=""),O())}function E(){f.classList.remove("is-hidden"),v.classList.add("is-hidden"),g.removeFromQueue(L),y.classList.contains("currentbtn")&&N(),0===g.getQueueFilmsList().length&&o()}function N(){document.getElementById(L.id).remove()}function O(){a([L])}y.addEventListener("click",(function(){i.libGallery.innerHTML="",a(g.getQueueFilmsList()),y.style.backgroundColor="#ff6b01",y.style.border="none",S.style.backgroundColor="transparent",S.style.border="1px solid white",S.classList.remove("currentbtn"),y.classList.add("currentbtn")})),S.addEventListener("click",(function(){i.libGallery.innerHTML="",a(g.getWathedFilmsList()),y.style.backgroundColor="transparent",y.style.border="1px solid white",S.style.backgroundColor="#ff6b01",S.style.border="none",y.classList.remove("currentbtn"),S.classList.add("currentbtn")}));
//# sourceMappingURL=library.3d2d2529.js.map
